<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<title>AI Chat Example</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<style>
body{font-family:Arial,Helvetica,sans-serif;background:#111;color:#eee;padding:24px}
.card{background:#1b1b1b;padding:16px;border-radius:8px;max-width:760px;margin:0 auto}
textarea,input,select{width:100%;padding:8px;margin:6px 0;border-radius:6px;background:#0f0f0f;border:1px solid #222;color:#eee}
button{padding:10px 14px;border-radius:6px;border:none;background:#2196f3;color:#fff;cursor:pointer}
pre{background:#0b0b0b;padding:12px;border-radius:6px;overflow:auto}
</style>
</head>
<body>
<div class="card">
<h2>AI Chat Example</h2>

<label>Model</label>
<select id="model">
    <option value="pi">pi (Aivrix)</option>
    <option value="pc">pc (Gemma 3 4B)</option>
</select>

<label>Prompt</label>
<textarea id="prompt" rows="6">Say hello and introduce yourself.</textarea>

<div style="display:flex;gap:8px;margin-top:8px">
    <button id="send">Send</button>
    <button id="clear">Clear</button>
</div>

<h3>Response</h3>
<pre id="response">(no response yet)</pre>
</div>

<script>
const API_KEY = 'TgpGudR3iMVSiTqAwSt2oA';
const API_HOST = 'https://ai.portalsbase.com'; // Can use relative path if hosted together

const sendBtn = document.getElementById('send');
const clearBtn = document.getElementById('clear');
const respEl = document.getElementById('response');
const promptEl = document.getElementById('prompt');
const modelEl = document.getElementById('model');

async function callGenerate(prompt, model='pi'){
    const url = API_HOST + '/api/generate';
    try {
        const r = await fetch(url, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': 'Bearer ' + API_KEY
            },
            body: JSON.stringify({ prompt, model })
        });
        const data = await r.json();
        if(!r.ok) throw new Error(data.error || JSON.stringify(data));
        return data;
    } catch(err) { throw err; }
}

sendBtn.addEventListener('click', async () => {
    respEl.textContent = 'Thinking...';
    sendBtn.disabled = true;
    try {
        const prompt = promptEl.value;
        const model = modelEl.value;
        const res = await callGenerate(prompt, model);
        // The AI reply is in res.response
        respEl.textContent = res.response || JSON.stringify(res, null, 2);
    } catch(e) {
        respEl.textContent = 'Error: ' + e.message;
    } finally { sendBtn.disabled = false; }
});

clearBtn.addEventListener('click', () => {
    promptEl.value = '';
    respEl.textContent = '(no response yet)';
});
</script>
</body>
</html>
